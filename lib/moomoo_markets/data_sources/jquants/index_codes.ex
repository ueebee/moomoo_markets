defmodule MoomooMarkets.DataSources.JQuants.IndexCodes do
  @moduledoc """
  指数コードを定数として管理するモジュール。
  J-Quants APIの指数四本値データで使用される指数コードを定義します。
  """

  @type index_code :: String.t()

  @doc """
  利用可能な指数コードの一覧を返します。
  """
  @spec all_codes() :: [index_code()]
  def all_codes do
    [
      # 主要指数
      "0000",  # TOPIX
      "0001",  # 東証二部総合指数（2022/4/1で廃止）

      # TOPIX Core30, Large70, 100, Mid400, 500, Small, 1000, Small500
      "0028", "0029", "002A", "002B", "002C", "002D", "002E", "002F",

      # 東証業種別指数
      "0040", "0041", "0042", "0043", "0044", "0045", "0046", "0047",
      "0048", "0049", "004A", "004B", "004C", "004D", "004E", "004F",
      "0050", "0051", "0052", "0053", "0054", "0055", "0056", "0057",
      "0058", "0059", "005A", "005B", "005C", "005D", "005E", "005F",
      "0060",

      # その他の指数
      "0070",  # 東証グロース市場250指数（旧：東証マザーズ指数）
      "0075",  # REIT

      # TOPIX-17業種別指数
      "0080", "0081", "0082", "0083", "0084", "0085", "0086", "0087",
      "0088", "0089", "008A", "008B", "008C", "008D", "008E", "008F",
      "0090",

      # 東証市場区分指数
      "0500", "0501", "0502", "0503",

      # TOPIX バリュー/グロース関連指数
      "8100", "812C", "812D", "8200", "822C", "822D",

      # 東証REIT関連指数
      "8501", "8502", "8503"
    ]
  end

  @doc """
  指数コードに対応する指数名を返します。
  """
  @spec get_name(index_code()) :: String.t()
  def get_name(code) do
    case code do
      # 主要指数
      "0000" -> "TOPIX"
      "0001" -> "東証二部総合指数"

      # TOPIX Core30, Large70, 100, Mid400, 500, Small, 1000, Small500
      "0028" -> "TOPIX Core30"
      "0029" -> "TOPIX Large 70"
      "002A" -> "TOPIX 100"
      "002B" -> "TOPIX Mid400"
      "002C" -> "TOPIX 500"
      "002D" -> "TOPIX Small"
      "002E" -> "TOPIX 1000"
      "002F" -> "TOPIX Small500"

      # 東証業種別指数
      "0040" -> "東証業種別 水産・農林業"
      "0041" -> "東証業種別 鉱業"
      "0042" -> "東証業種別 建設業"
      "0043" -> "東証業種別 食料品"
      "0044" -> "東証業種別 繊維製品"
      "0045" -> "東証業種別 パルプ・紙"
      "0046" -> "東証業種別 化学"
      "0047" -> "東証業種別 医薬品"
      "0048" -> "東証業種別 石油・石炭製品"
      "0049" -> "東証業種別 ゴム製品"
      "004A" -> "東証業種別 ガラス・土石製品"
      "004B" -> "東証業種別 鉄鋼"
      "004C" -> "東証業種別 非鉄金属"
      "004D" -> "東証業種別 金属製品"
      "004E" -> "東証業種別 機械"
      "004F" -> "東証業種別 電気機器"
      "0050" -> "東証業種別 輸送用機器"
      "0051" -> "東証業種別 精密機器"
      "0052" -> "東証業種別 その他製品"
      "0053" -> "東証業種別 電気・ガス業"
      "0054" -> "東証業種別 陸運業"
      "0055" -> "東証業種別 海運業"
      "0056" -> "東証業種別 空運業"
      "0057" -> "東証業種別 倉庫・運輸関連業"
      "0058" -> "東証業種別 情報・通信業"
      "0059" -> "東証業種別 卸売業"
      "005A" -> "東証業種別 小売業"
      "005B" -> "東証業種別 銀行業"
      "005C" -> "東証業種別 証券・商品先物取引業"
      "005D" -> "東証業種別 保険業"
      "005E" -> "東証業種別 その他金融業"
      "005F" -> "東証業種別 不動産業"
      "0060" -> "東証業種別 サービス業"

      # その他の指数
      "0070" -> "東証グロース市場250指数"
      "0075" -> "REIT"

      # TOPIX-17業種別指数
      "0080" -> "TOPIX-17 食品"
      "0081" -> "TOPIX-17 エネルギー資源"
      "0082" -> "TOPIX-17 建設・資材"
      "0083" -> "TOPIX-17 素材・化学"
      "0084" -> "TOPIX-17 医薬品"
      "0085" -> "TOPIX-17 自動車・輸送機"
      "0086" -> "TOPIX-17 鉄鋼・非鉄"
      "0087" -> "TOPIX-17 機械"
      "0088" -> "TOPIX-17 電機・精密"
      "0089" -> "TOPIX-17 情報通信・サービスその他"
      "008A" -> "TOPIX-17 電力・ガス"
      "008B" -> "TOPIX-17 運輸・物流"
      "008C" -> "TOPIX-17 商社・卸売"
      "008D" -> "TOPIX-17 小売"
      "008E" -> "TOPIX-17 銀行"
      "008F" -> "TOPIX-17 金融（除く銀行）"
      "0090" -> "TOPIX-17 不動産"

      # 東証市場区分指数
      "0500" -> "東証プライム市場指数"
      "0501" -> "東証スタンダード市場指数"
      "0502" -> "東証グロース市場指数"
      "0503" -> "JPXプライム150指数"

      # TOPIX バリュー/グロース関連指数
      "8100" -> "TOPIX バリュー"
      "812C" -> "TOPIX500 バリュー"
      "812D" -> "TOPIXSmall バリュー"
      "8200" -> "TOPIX グロース"
      "822C" -> "TOPIX500 グロース"
      "822D" -> "TOPIXSmall グロース"

      # 東証REIT関連指数
      "8501" -> "東証REIT オフィス指数"
      "8502" -> "東証REIT 住宅指数"
      "8503" -> "東証REIT 商業・物流等指数"

      _ -> raise ArgumentError, "Invalid index code: #{code}"
    end
  end

  @doc """
  指数コードが有効かどうかを確認します。
  """
  @spec valid_code?(index_code()) :: boolean()
  def valid_code?(code) do
    code in all_codes()
  end
end
